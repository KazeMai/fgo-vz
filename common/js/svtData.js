object_extend("mstSvtSkill",'{"strengthStatus":0,"svtId":9941040,"num":1,"priority":1,"skillId":435350,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condLimitCount":-1,"eventId":0},{"strengthStatus":0,"svtId":9941040,"num":2,"priority":1,"skillId":436450,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condLimitCount":-1,"eventId":0},{"strengthStatus":0,"svtId":9941040,"num":3,"priority":1,"skillId":437551,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condLimitCount":-1,"eventId":0}');
object_extend("mstSvtSkill",'{"svtId":9940380,"num":1,"priority":1,"skillId":960182,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940390,"num":1,"priority":1,"skillId":960184,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940400,"num":1,"priority":1,"skillId":960183,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940410,"num":1,"priority":1,"skillId":960185,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940530,"num":1,"priority":2,"skillId":960189,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940530,"num":2,"priority":2,"skillId":960190,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940530,"num":3,"priority":2,"skillId":960191,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940530,"num":4,"priority":2,"skillId":960192,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940530,"num":5,"priority":2,"skillId":960193,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940530,"num":6,"priority":2,"skillId":960194,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940530,"num":7,"priority":2,"skillId":960195,"condQuestId":0,"condLv":0,"condLimitCount":-1},{"svtId":9940600,"num":4,"priority":1,"skillId":960235,"condQuestId":0,"condLv":0,"condLimitCount":-1}');
object_extend("mstSvtTreasureDevice",'{"damage":[100],"svtId":9935400,"num":1,"priority":426,"imageIndex":0,"treasureDeviceId":441,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condFriendshipRank":0,"motion":50,"cardId":1},{"damage":[16,33,51],"svtId":9935500,"num":1,"priority":101,"imageIndex":0,"treasureDeviceId":9935511,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condFriendshipRank":0,"motion":50,"cardId":1},{"damage":[100],"strengthStatus":0,"svtId":9943610,"num":1,"priority":1,"flag":0,"imageIndex":0,"treasureDeviceId":725,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condFriendshipRank":0,"motion":30,"cardId":1},{"damage":[10,20,30,40],"strengthStatus":0,"treasureDeviceNum":1,"svtId":204900,"num":98,"priority":101,"flag":0,"imageIndex":0,"treasureDeviceId":204998,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condFriendshipRank":0,"motion":50,"cardId":1}');
//上杉謙信
object_extend("mstTreasureDevice",'{"individuality":[],"script":{},"id":9945331,"seqId":9945330,"name":"尚未實裝","ruby":"","rank":"","maxLv":5,"typeText":"","attackAttri":1,"effectFlag":2}');
object_extend("mstTreasureDeviceDetail",'{"id":9945331,"detail":"","detailShort":""}');
object_extend("mstTreasureDeviceLv",'{"funcId":[],"svals":[],"svals2":[],"svals3":[],"svals4":[],"svals5":[],"script":{},"treaureDeviceId":9945331,"lv":1,"gaugeCount":1,"detailId":1,"tdPoint":0,"tdPointQ":0,"tdPointA":0,"tdPointB":0,"tdPointEx":0,"tdPointDef":0,"qp":0}');
//芭班．希(Pretender)
//object_extend("mstSkill",'{"effectList":[],"actIndividuality":[],"script":{},"id":99970417,"type":1,"name":"ミコノス☆ミコケル EX","ruby":"-","maxLv":1,"iconId":321,"motion":104},{"effectList":[],"actIndividuality":[],"script":{},"id":99970418,"type":1,"name":"雨の国の後継 EX","ruby":"-","maxLv":1,"iconId":512,"motion":104},{"effectList":[],"actIndividuality":[],"script":{},"id":99970419,"type":1,"name":"ミコノス・ハンマー B","ruby":"-","maxLv":1,"iconId":302,"motion":102}');
//object_extend("mstSkill",'{"effectList":[],"actIndividuality":[],"script":{},"id":99970417,"type":1,"name":"ミコノス☆ミコケル EX","ruby":"-","maxLv":1,"iconId":321,"motion":104},{"effectList":[],"actIndividuality":[],"script":{},"id":99970418,"type":1,"name":"雨の国の後継 EX","ruby":"-","maxLv":1,"iconId":512,"motion":104},{"effectList":[],"actIndividuality":[],"script":{},"id":99970419,"type":1,"name":"ミコノス・ハンマー B","ruby":"-","maxLv":1,"iconId":302,"motion":102}');
//object_extend("mstSkillDetail",'{"id":99970417,"detail":"","detailShort":""},{"id":99970418,"detail":"","detailShort":""},{"id":99970419,"detail":"","detailShort":""}');
//object_extend("mstSkillLv",'{"funcId":[152,182,21123,21124],"svals":["[1000,3,-1,100]","[1000,3,-1,100]","[1000,3,-1,TargetList:3060/3080/3081]","[1000,3,-1,TargetList:3011/3015/3026]"],"script":{},"skillId":99970417,"lv":1,"chargeTurn":0,"skillDetailId":1,"priority":0},{"funcId":[433,416,305,468,470],"svals":["[1000]","[1000,3,-1,200]","[1000,3,-1,200]","[1000,2000]","[1000,1]"],"script":{},"skillId":99970418,"lv":1,"chargeTurn":0,"skillDetailId":1,"priority":0},{"funcId":[254,215,21133,21126],"svals":["[1000,3,-1,100]","[1000,2,-1,200]","[1000,3,-1,100]","[1000,1]"],"script":{},"skillId":99970419,"lv":1,"chargeTurn":0,"skillDetailId":1,"priority":0}');
//object_extend("mstSvtSkill",'{"script":{},"strengthStatus":0,"skillNum":1,"svtId":9945130,"num":1,"priority":1,"skillId":99970417,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condLimitCount":-1,"eventId":0,"flag":0},{"script":{},"strengthStatus":0,"skillNum":1,"svtId":9945130,"num":2,"priority":1,"skillId":99970418,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condLimitCount":-1,"eventId":0,"flag":0},{"script":{},"strengthStatus":0,"skillNum":1,"svtId":9945130,"num":3,"priority":1,"skillId":99970419,"condQuestId":0,"condQuestPhase":0,"condLv":0,"condLimitCount":-1,"eventId":0,"flag":0}');

function object_extend(key,extendtxt)
{
	var isErr = false;
	extendtxt = extendtxt.replace(/\n/g,"\\n").replace(/\\"/g,"\\\"").replace(/\"なし\"/g,"\"－\"");
	try{
		var tmpMst = JSON.parse('['+extendtxt+']');
		for(var i in tmpMst)
		{
			master[key].push(tmpMst[i]);
		}
	}
	catch(err){console.log(err.message+'\n'+key);isErr=true;}
	if(isErr) alert('存取錯誤');
}
/*暫時應對*/
sortByElmentNo(master.mstSvt);
var zhTWNo=367,zhCNNo=385,statusNo=417,personalityList=" \u5584 \u60e1 \u4e2d\u7acb \u72c2 \u4e2d\u5eb8 \u5584\uff0f\u60e1 \u82b1\u5ac1 \u590f".split(" "),policyList=" \u4e2d\u7acb \u6df7\u6c8c \u79e9\u5e8f \u4e2d\u5eb8 \u79e9\u5e8f\uff0f\u6df7\u6c8c \u7a7a\u5bc6".split(" "),attriList="\uff1f \u4eba \u5929 \u5730 \u661f \u7378     \u7121".split(" "),genderTypeList=["","\u7537\u6027","\u5973\u6027","\u4e0d\u660e"],cardList=["","0000ff","ff0000","00ff00"],svtStatusList=" A B C D E EX ? ? ".split(" "),
svtStatusPlusList="  + ++ - +++ - ? \uff1f \uff0d".split(" ");
function svtDataTable(e){var a,k;for(k in master.mstSvt)if(master.mstSvt[k].id==e)break;var m=null;for(t in master.mstSvtLimit)if(master.mstSvtLimit[t].svtId==e){m=master.mstSvtLimit[t];break}var t=null;for(a in master.mstSvtLimit)if(master.mstSvtLimit[a].svtId==e&&master.mstSvtLimit[a].limitCount==master.mstSvt[k].limitMax){t=master.mstSvtLimit[a];break}var c="<tr>";master.mstSvt[k].collectionNo<=statusNo&&9!=master.mstSvt[k].type?(c+="<td rowspan=7 align=center style='width:25%;height:300px;'>",
c=5==master.mstSvt[k].type||9==master.mstSvt[k].type||99==master.mstSvt[k].type?c+("<img src=https://fgo.kazemai.io/common/images/Servants/Status/"+e+"/status_servant_2.png onerror=\"javascript:this.style='display:none'\" width=256 height=256 /></td>"):c+("<div class='slide'><div><img src=https://fgo.kazemai.io/common/images/Servants/Status/"+e+"/status_servant_1.png onerror=\"this.style.display = 'none'\" width=256 height=256 /></div><div><img src=https://fgo.kazemai.io/common/images/Servants/Status/"+
e+"/status_servant_2.png onerror=\"this.style.display = 'none'\" width=256 height=256 /></div><div><img src=https://fgo.kazemai.io/common/images/Servants/Status/"+e+"/status_servant_3.png onerror=\"this.style.display = 'none'\" width=256 height=256 /></div></div></td>")):c+="<td rowspan=7 align=center style='width:25%;height:300px;'><img src='https://fgo.kazemai.io/common/images/icon/faces/"+master.mstSvt[k].id+"0.png' onerror=javascript:this.src='https://fgo.kazemai.io/common/images/icon/faces/0.png'></td>";
c+="<th style='width:10%;'><b>\u7de8\u865f</b></th><th style='width:10%;'><b>\u661f\u6578</b></th><th colspan=2 style='width:40%;'><b>\u540d\u7a31</b></th><th style='width:10%;'><b>\u8077\u968e</b></th><th style='width:10%;'><b>\u526f\u5c6c\u6027</b></th></tr><tr align=\"center\"><td>No."+master.mstSvt[k].collectionNo+'</td><td class="star">';for(a=0;a<m.rarity;a++)c+="\u2605";if(null!=t&&t.rarity!=m.rarity)for(c+="<br>",a=0;a<t.rarity;a++)c+="\u2605";0==m.rarity&&(c+="\uff0d");c+="</td><td colspan=2>";
c=(a=findSvtNameZh(master.mstSvt[k].id))&&!document.getElementById("isJpTxt").checked?c+("<ruby>"+a+"<rt>"+master.mstSvt[k].ruby+"</rt></ruby>"):c+master.mstSvt[k].name;for(var d in master.mstSvtTransform)if(master.mstSvtTransform[d].befSvtId==e){c+="<img src='https://fgo.kazemai.io/common/images/btn_change_svt.png' class='itemS' style='vertical-align: text-bottom;' onClick='svtTranform("+master.mstSvtTransform[d].aftSvtId+");' />";break}else if(master.mstSvtTransform[d].aftSvtId==e){c+="<img src='https://fgo.kazemai.io/common/images/btn_change_svt.png' class='itemS' style='vertical-align: text-bottom;' onClick='svtTranform("+
master.mstSvtTransform[d].befSvtId+");' />";break}c+="</td>";document.title=findSvtNameZh2(e)+" - \u5f9e\u8005\u8cc7\u6599\u67e5\u8a62";for(a=0;a<mstClass.length;a++)if(mstClass[a].id==master.mstSvt[k].classId){c+="<td>"+mstClass[a].name+"</td>";break}c+="<td>"+attriList[master.mstSvt[k].attri]+"</td></tr><tr><th><b>HP</b></th><th><b>ATK</b></th><th style='width:15%;'><b>\u7e6a\u5e2b</b></th><th style='width:15%;'><b>CV</b></th><th><b>\u5c6c\u6027</b></th><th><b>\u6027\u5225</b></th></tr><tr align=\"center\"><td>"+
m.hpBase+" / "+m.hpMax;null==t||m.hpBase==t.hpBase&&m.hpMax==t.hpMax||(c+="<br>"+t.hpBase+" / "+t.hpMax);c+="</td><td>"+m.atkBase+" / "+m.atkMax;null==t||m.atkBase==t.atkBase&&m.atkMax==t.atkMax||(c+="<br>"+t.atkBase+" / "+t.atkMax);c+="</td><td>";if(-1!=master.mstSvt[k].illustratorId)for(a=0;a<master.mstIllustrator.length;a++){if(master.mstIllustrator[a].id==master.mstSvt[k].illustratorId){c+="<a href='illustrator.html#"+master.mstSvt[k].illustratorId+"'>"+master.mstIllustrator[a].name.replace(/\(/g,
"<br>(")+"</a>";break}}else c+="\uff1f\uff1f\uff1f";c+="</td><td>";if(-1!=master.mstSvt[k].cvId)for(a=0;a<master.mstCv.length;a++){if(master.mstCv[a].id==master.mstSvt[k].cvId){c+="<a href='cv.html#"+master.mstSvt[k].cvId+"'>"+master.mstCv[a].name.replace(/\uff06/g,"<br>")+"</a>";break}}else c+="\uff1f\uff1f\uff1f";c=c+"</td><td>"+(policyList[m.policy]+"\u30fb"+personalityList[m.personality]+"</td><td>"+genderTypeList[master.mstSvt[k].genderType]+"</td></tr>");d=[];for(a in master.mstSvt[k].individuality)indi_list[master.mstSvt[k].individuality[a]]&&
d.push(indi_list[master.mstSvt[k].individuality[a]].name.replace(/@/g,""));c+="<tr><th>\u7279\u6027</th><td colspan=5 align=center id=indi>"+d+"<br></td></tr>";document.getElementById("svtNrmlData").innerHTML=c;c='<tr><th rowspan=2><b>\u6307\u4ee4\u5361</b></th><th><font color="#0099FF"><b>Arts</b></font></th><th><font color="#ff0000"><b>Buster</b></font></th><th><font color="#00ff00"><b>Quick</b></font></th><th><b>Extra</b></th><th rowspan=2><b>\u96b1\u85cf\u6578\u503c</b></th><th><b>\u661f\u661f\u767c\u751f\u7387</b></th><th><b>\u88ab\u5373\u6b7b\u7387</b></th><th><b>\u661f\u661f\u5206\u914d\u6bd4\u91cd</b></th><th rowspan=2><b>NP\u7372\u5f97\u7387</b></th><th><font color="#0099FF"><b>Arts</b></font></th><th><font color="#ff0000"><b>Buster</b></font></th><th><font color="#00ff00"><b>Quick</b></font></th><th><b>Extra</b></th><th><b>\u5bf6\u5177</b></th><th><b>\u9632\u79a6</b></th></tr><tr align="center">';
for(d=1;4>=d;d++){c+="<td>";var u=0;for(a=0;a<master.mstSvt[k].cardIds.length;a++)master.mstSvt[k].cardIds[a]==d&&u++;4!=d&&(c+=u+"\u5f35 ");for(a=0;a<master.mstSvtCard.length;a++)master.mstSvtCard[a].svtId==master.mstSvt[k].id&&master.mstSvtCard[a].cardId==d&&(4!=d&&(c+="\u5404"),c+=master.mstSvtCard[a].normalDamage.length+"Hit",1<master.mstSvtCard[a].normalDamage.length&&(c+="s"),2==master.mstSvtCard[a].attackType&&(c+="<br/>\u203b\u5168\u9ad4"));c+="</td>"}c+="<td>"+master.mstSvt[k].starRate/10+
"%</td><td>"+master.mstSvt[k].deathRate/10+"%</td><td>"+m.criticalWeight+"</td>";u=[];for(var p=0;6>p;p++)u[p]=[];for(var x in master.mstSvtTreasureDevice)if(master.mstSvtTreasureDevice[x].svtId==master.mstSvt[k].id&&0!=master.mstSvtTreasureDevice[x].priority)for(a in master.mstTreasureDeviceLv)if(master.mstTreasureDeviceLv[a].treaureDeviceId==master.mstSvtTreasureDevice[x].treasureDeviceId){var f=[master.mstTreasureDeviceLv[a].tdPointA,master.mstTreasureDeviceLv[a].tdPointB,master.mstTreasureDeviceLv[a].tdPointQ,
master.mstTreasureDeviceLv[a].tdPointEx,master.mstTreasureDeviceLv[a].tdPoint,master.mstTreasureDeviceLv[a].tdPointDef];for(p=0;6>p;p++)0!=u[p].length&&u[p][u[p].length-1]==f[p]||u[p].push(f[p])}for(p=0;6>p;p++)c+="<td>"+npArray(u[p])+"</td>";c+="</tr>";document.getElementById("svtCtrlData").innerHTML=c;c=x="";u=1;var B=[];for(a=0;a<master.mstSvtSkill.length;a++)if(master.mstSvtSkill[a].svtId==master.mstSvt[k].id&&!B.includes(master.mstSvtSkill[a].skillId)){B.push(master.mstSvtSkill[a].skillId);for(d=
0;d<master.mstSkill.length;d++)if(master.mstSvtSkill[a].skillId==master.mstSkill[d].id){c+="<td><img src=https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_"+master.mstSkill[d].iconId+".png onerror=javascript:this.src='https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_0.png' width=55></img></td><td>";5!=master.mstSvt[k].type&&(c+="<font color=#007979>SKILL "+master.mstSvtSkill[a].num+"</font><br>");c+="<b>"+master.mstSkill[d].name+"</b>";for(var r in master.mstSkillAdd)master.mstSkillAdd[r].skillId==
master.mstSkill[d].id&&(c+=' <span data-flow="top" data-tooltip="'+commonReleaseCheck(master.mstSkillAdd[r].commonReleaseId)+"\u540d\u7a31\u8b8a\u6210\u300c"+master.mstSkillAdd[r].name+'\u300d">\u203b</span>');c+="</td>";break}if(null==master.mstSkill[d])console.log("\u6280\u80fd\u5c0b\u627e\u5931\u6557");else{u++;for(d=0;d<master.mstSkillLv.length;d++)if(master.mstSvtSkill[a].skillId==master.mstSkillLv[d].skillId&&1==master.mstSkillLv[d].lv){c+="<td colspan=5>\u51b7\u537b"+master.mstSkillLv[d].chargeTurn+
"\u56de\u5408</td>";break}c+="<td colspan=5>";-1==master.mstSvtSkill[a].condLimitCount?c+="\u6575\u4eba\u6216\u7279\u6b8a\u652f\u63f4\u9650\u5b9a\uff0c\u51b7\u537b\u53ca\u6548\u679c\u50c5\u4f9b\u53c3\u8003":(0==master.mstSvtSkill[a].condLimitCount&&0==master.mstSvtSkill[a].condQuestId&&0==master.mstSvtSkill[a].condLv&&(c+="\u521d\u671f"),0!=master.mstSvtSkill[a].condLimitCount&&(c+="\u9748\u57fa\u518d\u81e8\u7b2c"+master.mstSvtSkill[a].condLimitCount+"\u968e\u6bb5<br>"),0!=master.mstSvtSkill[a].condLv&&
(c+="Lv."+master.mstSvtSkill[a].condLv+"<br>"),0!=master.mstSvtSkill[a].condQuestId&&(c+="\u901a\u904e\u95dc\u5361 "+questRea(master.mstSvtSkill[a].condQuestId)+"<br>"));for(var q in master.mstSvtSkillRelease)if(master.mstSvtSkillRelease[q].svtId==master.mstSvtSkill[a].svtId&&master.mstSvtSkillRelease[q].num==master.mstSvtSkill[a].num&&master.mstSvtSkillRelease[q].priority==master.mstSvtSkill[a].priority){if(70==master.mstSvtSkillRelease[q].condType)if(11>master.mstSvtSkillRelease[q].condNum)c+="\u9650\u5b9a\u6230\u9b25\u89d2\u8272\u9078\u64c7\u7b2c"+
master.mstSvtSkillRelease[q].condNum+"\u968e\u6bb5<br>";else for(var v in master.mstSvtCostume)if(master.mstSvtCostume[v].svtId==master.mstSvtSkillRelease[q].svtId&&master.mstSvtCostume[v].id==master.mstSvtSkillRelease[q].condNum){c+="\u88dd\u5099\u9748\u8863 "+master.mstSvtCostume[v].shortName+"<br>";break}break}c+="</td></tr>";f=[];for(d=0;d<skDetail.length;d++)if(master.mstSvtSkill[a].skillId==skDetail[d][0]){f=skDetail[d].slice(0);break}if(document.getElementById("isJpTxt").checked||!f[1])for(d=
0;d<master.mstSkillDetail.length;d++)if(master.mstSvtSkill[a].skillId==master.mstSkillDetail[d].id){f[1]=master.mstSkillDetail[d].detail;break}var h=[];document.getElementById("isJpTxt").checked?h[0]=f[1].slice(0):(f[1]=f[1].replace(/ \uff0b |\u3000\uff0b\u3000/g,"\uff0b"),f[1]=f[1].replace(/\uff06/g,"\uff06\u2517"),h=f[1].split(/\uff06|\uff0b/));u+=h.length;for(var b=0;b<h.length;b++){h[b].search(/\{0\}|Lv/);h[b]=h[b].replace(/\{0\}/g,"Lv.");h[b]=h[b].replace(/\[Lv.]/g,'<font color="#CC00CC ">[Lv.]</font>');
h[b]=h[b].replace(/\u3010/g,'<font color="#006400 ">\u3010');h[b]=h[b].replace(/\u3011/g,"\u3011</font>");h[b]=h[b].replace(/\n/g,"<br>");h[b]=h[b].replace(/\[g\]\[o\]\u25b2\[\/o\]\[\/g\]/g,"\u25b2");h[b]=h[b].replace(/\u25b2/g,'<font color="#ff7f0f ">\u25b2</font>');if(document.getElementById("isJpTxt").checked)c+="<tr><td colspan=12>"+h[b]+"</td>";else if(c+="<tr><td colspan=2>"+h[b]+"</td>",f[2+b]&&1<f[2+b].split("/").length-1)for(d in p=[],p=f[2+b].split(/\//),p)c+="<td align=center style='width:50px'>"+
p[d]+"</td>";else c+="<td colspan=10>",c=f[2+b]?c+("\u3000"+f[2+b].replace(/\//g," / ")):"undefined"!==typeof f[2+b]&&0==f[2+b].length?c+"\u3000---":c+"\u3000\u5f85\u88dc";c+="</td></tr>"}}}0<c.length&&(x+="<tr><th style='width:60px' rowspan="+u+"><b>\u4fdd\u6709\u6280\u80fd</b></th><th colspan=2 style='width:300px'>\u6280\u80fd</th><th colspan=5 style='width:250px'>\u51b7\u537b\u6642\u9593(Lv.6\u8207Lv.10\u5404\u6e1b\u5c111\u56de\u5408)</th><th colspan=5 style='width:250px'>\u958b\u653e\u689d\u4ef6</th></tr><tr>"+
c);if(0!=master.mstSvt[k].classPassive.length){c="";for(a=u=0;a<master.mstSvt[k].classPassive.length;a++){u++;for(d=0;d<master.mstSkill.length;d++)if(master.mstSvt[k].classPassive[a]==master.mstSkill[d].id){c+="<td style='width:55px'><img src=https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_"+master.mstSkill[d].iconId+".png onerror=javascript:this.src='https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_0.png' width=55></img></td><td style='width:250px'><b>"+master.mstSkill[d].name+"</b>";
for(r in master.mstSkillAdd)master.mstSkillAdd[r].skillId==master.mstSkill[d].id&&(c+=' <span data-flow="top" data-tooltip="'+commonReleaseCheck(master.mstSkillAdd[r].commonReleaseId)+"\u540d\u7a31\u8b8a\u6210\u300c"+master.mstSkillAdd[r].name+'\u300d">\u203b</span>');c+="</td>";break}f=[];for(s in skDetail)if(master.mstSvt[k].classPassive[a]==skDetail[s][0]){f=skDetail[s].slice(0);break}if(document.getElementById("isJpTxt").checked||!f[1])for(s=0;s<master.mstSkillDetail.length;s++)if(master.mstSvt[k].classPassive[a]==
master.mstSkillDetail[s].id){f[1]=master.mstSkillDetail[s].detail;break}h=[];document.getElementById("isJpTxt").checked?h[0]=f[1].slice(0):(f[1]=f[1].replace(/ \uff0b |\u3000\uff0b\u3000/g,"\uff0b"),f[1]=f[1].replace(/\uff06/g,"\uff06\u2517"),h=f[1].split(/\uff06|\uff0b/));c+="<td colspan=10 style='width:500px'>";for(b=0;b<h.length;b++)if(h[b].search(/\{0\}|Lv/),h[b]=h[b].replace(/\{0\}/g,"Lv."),h[b]=h[b].replace(/\[Lv.]/g,'<font color="#CC00CC ">[Lv.]</font>'),h[b]=h[b].replace(/\u3010/g,'<font color="#006400 ">\u3010'),
h[b]=h[b].replace(/\u3011/g,"\u3011</font>"),h[b]=h[b].replace(/\n/g,"<br>"),h[b]=h[b].replace(/\[g\]\[o\]\u25b2\[\/o\]\[\/g\]/g,"\u25b2"),h[b]=h[b].replace(/\u25b2/g,'<font color="#ff7f0f ">\u25b2</font>'),document.getElementById("isJpTxt").checked)c+=h[b];else if(0!=b&&(c+="<br>"),c+=h[b],f[2+b]&&1<f[2+b].split("/").length-1)for(d in c+=h[b]+"\uff1a",p=[],p=f[2+b].split(/\//),p)c+=p[d];else c=f[2+b]?c+("\uff1a"+f[2+b].replace(/\//g," / ")):"undefined"!==typeof f[2+b]&&0==f[2+b].length?c+"":c+"\uff1a\u5f85\u88dc";
c+="</td></tr>"}for(a in master.mstSvtPassiveSkill)if(master.mstSvtPassiveSkill[a].svtId==e&&0==master.mstSvtPassiveSkill[a].eventId&&0==master.mstSvtPassiveSkill[a].flag){u++;for(d=0;d<master.mstSkill.length;d++)if(master.mstSvtPassiveSkill[a].skillId==master.mstSkill[d].id){c+="<td style='width:55px'><img src=https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_"+master.mstSkill[d].iconId+".png onerror=javascript:this.src='https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_0.png' width=55></img></td><td style='width:250px'><b>"+
master.mstSkill[d].name+"</b>";for(r in master.mstSkillAdd)master.mstSkillAdd[r].skillId==master.mstSkill[d].id&&(c+=' <span data-flow="top" data-tooltip="'+commonReleaseCheck(master.mstSkillAdd[r].commonReleaseId)+"\u540d\u7a31\u8b8a\u6210\u300c"+master.mstSkillAdd[r].name+'\u300d">\u203b</span>');c+="</td>";break}f=[];for(s=0;d<skDetail.length;s++)if(master.mstSvtPassiveSkill[a].skillId==skDetail[s][0]){f=skDetail[s].slice(0);break}if(document.getElementById("isJpTxt").checked||!f[1])for(s=0;s<
master.mstSkillDetail.length;s++)if(master.mstSvt[k].classPassive[a]==master.mstSkillDetail[s].id){f[1]=master.mstSkillDetail[s].detail;break}h=[];document.getElementById("isJpTxt").checked?h[0]=f[1].slice(0):(f[1]=f[1].replace(/ \uff0b |\u3000\uff0b\u3000/g,"\uff0b"),f[1]=f[1].replace(/\uff06/g,"\uff06\u2517"),h=f[1].split(/\uff06|\uff0b|\+/));c+="<td colspan=10 style='width:500px'>";c+="<font color='#20c0ff'>\u958b\u653e\u689d\u4ef6\uff1a";0==master.mstSvtPassiveSkill[a].condLimitCount&&0==master.mstSvtPassiveSkill[a].condQuestId&&
0==master.mstSvtPassiveSkill[a].condLv&&(c+="\u521d\u671f");0!=master.mstSvtPassiveSkill[a].condLimitCount&&(c+="\u9748\u57fa\u518d\u81e8\u7b2c"+master.mstSvtSkill[a].condLimitCount+"\u968e\u6bb5");0!=master.mstSvtPassiveSkill[a].condLv&&(c+="Lv.\u5230\u9054"+master.mstSvtSkill[a].condLv+"<br>");0!=master.mstSvtPassiveSkill[a].condQuestId&&(c+="\u901a\u904e\u95dc\u5361 "+questRea(master.mstSvtPassiveSkill[a].condQuestId)+"<br>");c+="</font><br>";for(b=0;b<h.length;b++)if(h[b].search(/\{0\}|Lv/),h[b]=
h[b].replace(/\{0\}/g,"Lv."),h[b]=h[b].replace(/\[Lv.]/g,'<font color="#CC00CC ">[Lv.]</font>'),h[b]=h[b].replace(/\u3010/g,'<font color="#006400 ">\u3010'),h[b]=h[b].replace(/\u3011/g,"\u3011</font>"),h[b]=h[b].replace(/\n/g,"<br>"),h[b]=h[b].replace(/\[g\]\[o\]\u25b2\[\/o\]\[\/g\]/g,"\u25b2"),h[b]=h[b].replace(/\u25b2/g,'<font color="#ff7f0f ">\u25b2</font>'),document.getElementById("isJpTxt").checked)c+=h[b];else if(0!=b&&(c+="<br>"),c+=h[b],f[2+b]&&1<f[2+b].split("/").length-1)for(d in c+=h[b]+
"\uff1a",p=[],p=f[2+b].split(/\//),p)c+=p[d];else c=f[2+b]?c+("\uff1a"+f[2+b].replace(/\//g," / ")):"undefined"!==typeof f[2+b]&&0==f[2+b].length?c+"":c+"\uff1a\u5f85\u88dc";c+="</td></tr>"}0<c.length&&(x+="<tr><th rowspan="+u+"><b>\u8077\u968e\u6280\u80fd</b></th>"+c)}c="";for(r=u=0;r<master.mstSvtAppendPassiveSkill.length;r++)if(master.mstSvtAppendPassiveSkill[r].svtId==e){u++;for(d=0;d<master.mstSkill.length;d++)if(master.mstSvtAppendPassiveSkill[r].skillId==master.mstSkill[d].id){c+="<td style='width:55px'><img src=https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_"+
master.mstSkill[d].iconId+".png onerror=javascript:this.src='https://fgo.kazemai.io/common/images/SkillIcon/SkillIcon_0.png' width=55></img></td><td style='width:250px'><b>"+master.mstSkill[d].name+"</b></td>";c+="<td colspan=10 style='width:500px'>";break}f=[];for(d=0;d<skDetail.length;d++)if(q=1+skDetail[d][0]-master.mstSvtAppendPassiveSkill[r].skillId,1<=q&&10>=q){f=skDetail[d].slice(0);if(document.getElementById("isJpTxt").checked||!f[1])for(s=0;s<master.mstSkillDetail.length;s++)if(master.mstSvtAppendPassiveSkill[r].skillId==
master.mstSkillDetail[s].id){f[1]=master.mstSkillDetail[s].detail;break}h=[];document.getElementById("isJpTxt").checked?h[0]=f[1].slice(0):(f[1]=f[1].replace(/ \uff0b |\u3000\uff0b\u3000/g,"\uff0b"),f[1]=f[1].replace(/\uff06/g,"\uff06\u2517"),h=f[1].split(/\uff06|\uff0b|\+/));for(b=0;b<h.length;b++)if(h[b].search(/\{0\}|Lv/),h[b]=h[b].replace(/\{0\}/g,"Lv."),h[b]=h[b].replace(/\[Lv.]/g,'<font color="#CC00CC ">[Lv.]</font>'),h[b]=h[b].replace(/\u3010/g,'<font color="#006400 ">\u3010'),h[b]=h[b].replace(/\u3011/g,
"\u3011</font>"),h[b]=h[b].replace(/\n/g,"<br>"),h[b]=h[b].replace(/\[g\]\[o\]\u25b2\[\/o\]\[\/g\]/g,"\u25b2"),h[b]=h[b].replace(/\u25b2/g,'<font color="#ff7f0f ">\u25b2</font>'),c+="<span class='apTxt apLv"+q+"'>Lv."+q+":",document.getElementById("isJpTxt").checked)c+=h[b];else if(0!=b&&(c+="<br>"),c+=h[b],f[2+b]&&1<f[2+b].split("/").length-1)for(d in c+=h[b]+"\uff1a",p=[],p=f[2+b].split(/\//),p)c+=p[d];else f[2+b]?c+="\uff1a"+f[2+b].replace(/\//g," / "):"undefined"!==typeof f[2+b]&&0==f[2+b].length&&
(c+="");c+="<br></span>"}c+="</td></tr>"}0<c.length&&(x+="<tr><th rowspan="+u+" style='width:60px'><b>\u9644\u52a0\u6280\u80fd</b><br><select id='apSelect' ></select></th>"+c);c="";u=0;r=[];for(d in master.mstSvtTreasureDevice)if(master.mstSvtTreasureDevice[d].svtId==master.mstSvt[k].id&&0!=master.mstSvtTreasureDevice[d].priority&&100!=master.mstSvtTreasureDevice[d].treasureDeviceId&&!r.includes(master.mstSvtTreasureDevice[d].treasureDeviceId)&&100>master.mstSvtTreasureDevice[d].treasureDeviceId-
master.mstSvtTreasureDevice[d].svtId)for(r.push(master.mstSvtTreasureDevice[d].treasureDeviceId),a=0;a<master.mstTreasureDevice.length;a++)if(master.mstTreasureDevice[a].id==master.mstSvtTreasureDevice[d].treasureDeviceId&&0<master.mstTreasureDevice[a].name.length){u+=2;c+="<th colspan=2 style='width:300px'><b>\u540d\u7a31</b></th><th colspan=2 style='width:100px'><b>\u7b49\u7d1a</b></th><th colspan=2 style='width:100px'><b>\u7a2e\u985e</b></th><th colspan=4 style='width:200px'><b>\u958b\u653e\u689d\u4ef6</b></th><th colspan=2 style='width:100px'>\u653b\u64ca\u6b21\u6578</th></tr>";
c+='<tr align="center"><td colspan=2><div class=ruby>'+master.mstTreasureDevice[a].ruby+"</div>";c+='<b><font color="#'+cardList[master.mstSvtTreasureDevice[d].cardId]+'">'+master.mstTreasureDevice[a].name.replace(/\[.*\]/g,"")+"</font></b></td><td colspan=2>"+master.mstTreasureDevice[a].rank.replace(/\u306a\u3057/g,"\u7121")+"</td><td colspan=2>"+master.mstTreasureDevice[a].typeText.replace(/\uff0f/g,"\uff0f<br>").replace(/\u5bfe/g,"\u5c0d").replace(/\u5b9d/g,"\u5bf6").replace(/\u5263/g,"\u528d").replace(/\u60aa/g,
"\u60e1").replace(/\u5965/g,"\u5967").replace(/\u30bb\u30a4\u30d0\u30fc/g,"Saber").replace(/\u7adc/g,"\u9f8d")+"</td><td colspan=4>";q=master.mstSvtTreasureDevice[d];p=!0;0==q.condQuestId&&0==q.condLv&&0==q.condFriendshipRank?0==q.priority&&(c+="\u6575\u4eba\u6216\u7279\u6b8a\u60c5\u6cc1\u9650\u5b9a<br>",p=!1):(null!=findName(master.mstQuest,q.condQuestId)&&(c+=questRea(q.condQuestId)+"<br>",p=!1),0!=q.condLv&&(c+="Lv."+q.condLv+"\u89e3\u653e<br>",p=!1),0!=q.condFriendshipRank&&(c+="\u7d46\u7b49\u7d1a"+
q.condFriendshipRank+"\u89e3\u653e<br>",p=!1));for(var l in master.mstSvtTreasureDeviceRelease)if(master.mstSvtTreasureDeviceRelease[l].svtId==q.svtId&&master.mstSvtTreasureDeviceRelease[l].num==q.num&&master.mstSvtTreasureDeviceRelease[l].priority==q.priority){if(70==master.mstSvtTreasureDeviceRelease[l].condType)if(11>master.mstSvtTreasureDeviceRelease[l].condNum)c+="\u9650\u5b9a\u6230\u9b25\u89d2\u8272\u9078\u64c7\u7b2c"+master.mstSvtTreasureDeviceRelease[l].condNum+"\u968e\u6bb5<br>",p=!1;else for(v in master.mstSvtCostume)if(master.mstSvtCostume[v].svtId==
master.mstSvtTreasureDeviceRelease[l].svtId&&master.mstSvtCostume[v].id==master.mstSvtTreasureDeviceRelease[l].condNum){c+="\u88dd\u5099\u9748\u8863 "+master.mstSvtCostume[v].shortName+"<br>";p=!1;break}break}p&&(c+="\uff0d");c+="</td>";q=[];for(b in tdDetail)if(master.mstTreasureDevice[a].id==tdDetail[b][0]){q=tdDetail[b].slice(0);break}if(document.getElementById("isJpTxt").checked||!q[1])for(b in master.mstTreasureDeviceDetail)if(master.mstTreasureDevice[a].id==master.mstTreasureDeviceDetail[b].id){q[1]=
master.mstTreasureDeviceDetail[b].detail;break}c+="<td colspan=2>";-1==q[1].search(/\u653b\u64ca[^\u529b\u6642]|\u653b\u6483[^\u529b\u6642]/)?c+="\uff0d":(c=0<master.mstSvtTreasureDevice[d].damage.length?c+master.mstSvtTreasureDevice[d].damage.length:c+"1",c+="Hit",1<master.mstSvtTreasureDevice[d].damage.length&&(c+="s"));c+="</td></tr>";f=[];document.getElementById("isJpTxt").checked?f[0]=q[1].slice(0):(q[1]=q[1].replace(/ \uff0b |\u3000\uff0b\u3000/g,"\uff0b"),q[1]=q[1].replace(/\uff06/g,"\uff06\u2517"),
f=q[1].split(/\uff06|\uff0b/));u+=f.length;for(b=0;b<f.length;b++){f[b].search(/\{0\}|Lv/);f[b].search(/<O|<\u30aa/);f[b]=f[b].replace(/\{0\}/g,"Lv.");f[b]=f[b].replace(/<O/g,'<font color="#97a834"><br>< O');f[b]=f[b].replace(/<\u30aa/g,'<font color="#97a834"><\u30aa');f[b]=f[b].replace(/P>/g,"P></font>");f[b]=f[b].replace(/\u30d7>/g,"\u30d7></font>");f[b]=f[b].replace(/\u3010/g,'<font color="#006400 ">\u3010');f[b]=f[b].replace(/\u3011/g,"\u3011</font>");f[b]=f[b].replace(/\[Lv.]/g,'<font color="#CC00CC ">[Lv.]</font>');
f[b]=f[b].replace(/\n/g,"<br>");f[b]=f[b].replace(/\[g\]\[o\]\u25b2\[\/o\]\[\/g\]/g,"\u25b2");f[b]=f[b].replace(/\u25b2/g,'<font color="#ff7f0f ">\u25b2</font>');if(document.getElementById("isJpTxt").checked)c+="<td colspan=12>"+f[b]+"</td>";else if(0!=b&&(c+="<tr>"),c+="<td colspan=2>"+f[b]+"</td>",q[2+b]&&1<q[2+b].split("/").length-1)for(g in p=[],p=q[2+b].split(/\//),p)c+="<td align=center colspan=2>"+p[g]+"</td>";else c+="<td colspan=10>",c=q[2+b]?c+("\u3000"+q[2+b]):"undefined"!==typeof q[2+
b]&&0==q[2+b].length?c+"\u3000---":c+"\u3000\u5f85\u88dc";c+="</td></tr>"}break}0<c.length&&(x+="<tr><th rowspan="+u+" style='width:60px'><b>\u5bf6\u5177</b></th>"+c);document.getElementById("svtSkTdData").innerHTML=x;$(".apTxt").css("display","none");$(".apLv1").css("display","block");$(".apLv10").css("display","block");for(b=10;0<b;b--)$("#apSelect").append('<option value="'+b+'">Lv.'+b+"</option>");$("#apSelect").on("change",function(){$("#apSelect option:selected").each(function(){$(".apTxt").css("display",
"none");$(".apLv"+$(this).val()).css("display","block")})});l="";l='<tr><th rowspan=2 style="width:250px">\u80fd\u529b\u503c</th><th style="width:80px">\u7b4b\u529b</th><th style="width:80px">\u8010\u4e45</th><th style="width:80px">\u654f\u6377</th><th style="width:80px">\u9b54\u529b</th><th style="width:80px">\u5e78\u904b</th><th style="width:80px">\u5bf6\u5177</th></tr><tr align="center"><td>'+svtStatusList[Math.floor(m.power/10)]+svtStatusPlusList[m.power%10]+"</td><td>"+svtStatusList[Math.floor(m.defense/
10)]+svtStatusPlusList[m.defense%10]+"</td><td>"+svtStatusList[Math.floor(m.agility/10)]+svtStatusPlusList[m.agility%10]+"</td><td>"+svtStatusList[Math.floor(m.magic/10)]+svtStatusPlusList[m.magic%10]+"</td><td>"+svtStatusList[Math.floor(m.luck/10)]+svtStatusPlusList[m.luck%10]+"</td><td>"+svtStatusList[Math.floor(m.treasureDevice/10)]+svtStatusPlusList[m.treasureDevice%10]+"</td></tr>";if(1E3!=master.mstSvt[k].friendshipId){d=5;r=[];"undefined"!==typeof master.mstSvt[k].maxFriendshipRank&&(d=master.mstSvt[k].maxFriendshipRank);
l+="<tr><th rowspan="+2*(10==d||2==master.mstSvt[k].type?15:5)/5+">\u7d46\u9ede\u6578<br>(\u7d2f\u7a4d)</th><th>Lv.1</th><th>Lv.2</th><th>Lv.3</th><th>Lv.4</th><th>Lv.5</th><th>";10==d&&(l+="\u5c08\u5c6c\u79ae\u88dd");l+='</th></tr><tr align="center">';for(a in master.mstFriendship)master.mstFriendship[a].id==master.mstSvt[k].friendshipId&&15>master.mstFriendship[a].rank&&(r[master.mstFriendship[a].rank]=master.mstFriendship[a].friendship);for(a=0;5>a;a++)l=0==a?l+("<td>"+addCommas(r[a])+"</td>"):
l+("<td>"+addCommas(r[a]-r[a-1])+"<br>("+addCommas(r[a])+")</td>");if(10==d||2==master.mstSvt[k].type){l+="<td rowspan=5>";for(var n in master.mstSkill)if(0<master.mstSkill[n].actIndividuality.length&&2==master.mstSkill[n].type&&-1!=$.inArray(master.mstSvt[k].id,master.mstSkill[n].actIndividuality)){for(var w in master.mstSvtSkill)if(master.mstSvtSkill[w].skillId==master.mstSkill[n].id&&0==master.mstSvtSkill[w].eventId){l+=svtFace(master.mstSvtSkill[w].svtId);break}break}if(e in ValCE)for(var y in ValCE[e])l+=
svtFace(ValCE[e][y]);l+="</td></tr>"}else l+="<td></td></tr>";if(5<d||2==master.mstSvt[k].type){l+='<tr><th>Lv.6</th><th>Lv.7</th><th>Lv.8</th><th>Lv.9</th><th>Lv.10</th></tr><tr align="center">';for(a=5;10>a;a++)l+="<td>",0<r[a]&&(l+=addCommas(r[a]-r[a-1])+"<br>("+addCommas(r[a])+")"),l+="</td>";l+='</tr><tr><th>Lv.11</th><th>Lv.12</th><th>Lv.13</th><th>Lv.14</th><th>Lv.15</th></tr><tr align="center">';for(a=10;15>a;a++)l+="<td>",0<r[a]&&(l+=addCommas(r[a]-r[a-1])+"<br>("+addCommas(r[a])+")"),l+=
"</td>";l+="</tr>"}}master.mstSvt[k].collectionNo>zhCNNo&&($("#cmtlang_zh").prop("checked",!1),$("#cmtlang_jp").prop("checked",!0));cmtRead($("input[name=cmtlang]:checked").val());$("#svtInfoData").html(l);w="";l={};w="<tr><th rowspan=4><b>\u9748\u57fa\u518d\u81e8</b></th>";for(n=0;4>n;n++){l="";0==n%2&&(l=' bgcolor=" #ECF2F3"');0!=n&&(w+="<tr>");w+="<td width=80 "+l+">\u7b2c"+(n+1)+"\u968e\u6bb5</td><td width=450"+l+">";for(a=0;a<master.mstCombineLimit.length;a++)if(master.mstCombineLimit[a].id==
master.mstSvt[k].id&&master.mstCombineLimit[a].svtLimit==n){for(d=0;d<master.mstCombineLimit[a].itemIds.length;d++)l=master.mstItem[findName(master.mstItem,master.mstCombineLimit[a].itemIds[d])],w+='<a href="item_drop.html#'+l.id+'"><div class="itemMT" title="'+l.name+'" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/'+l.imageId+".png')\" >"+master.mstCombineLimit[a].itemNums[d]+'</div></a><div style="width:10px;display:inline-block;"></div>';w+='<div class="itemMT" title="QP" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/5.png\')" >'+
numeral(master.mstCombineLimit[a].qp).format("0a")+"</div>"}w+="</td></tr>"}y=0;n="";for(a=0;a<master.mstCombineSkill.length;a++)if(l="",1==a%2&&(l=' bgcolor=" #ECF2F3"'),master.mstCombineSkill[a].id==master.mstSvt[k].id){1!=master.mstCombineSkill[a].skillLv&&(n+="<tr>");n+="<td"+l+">Lv."+master.mstCombineSkill[a].skillLv+"\u2192Lv."+(master.mstCombineSkill[a].skillLv+1)+"</td><td"+l+">";for(d=0;d<master.mstCombineSkill[a].itemIds.length;d++)l=master.mstItem[findName(master.mstItem,master.mstCombineSkill[a].itemIds[d])],
n+='<a href="item_drop.html#'+l.id+'"><div class="itemMT" title="'+l.name+'" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/'+l.imageId+".png')\" >"+master.mstCombineSkill[a].itemNums[d]+'</div></a><div style="width:10px;display:inline-block;"></div>';n+='<div class="itemMT" title="QP" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/5.png\')" >'+numeral(master.mstCombineSkill[a].qp).format("0a")+"</div>";y++}w=0==y?w+"<tr><th><b>\u4fdd\u6709\u6280\u80fd\u5f37\u5316</b></th><td colspan=2>\u7121</td></tr>":
w+("<tr><th rowspan="+y+"><b>\u4fdd\u6709\u6280\u80fd\u5f37\u5316</b></th>"+n);y=0;n="";for(a=0;a<master.mstSvtCoin.length;a++)if(master.mstSvtCoin[a].svtId==master.mstSvt[k].id){n+="<tr><td>\u7372\u5f97\u5f9e\u8005<br>\u6642\u589e\u52a0\u6578</td><td>";l=master.mstItem[findName(master.mstItem,master.mstSvtCoin[a].itemId)];n+='<div class="itemMT" title="'+l.name+'" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/'+l.imageId+".png')\" >"+master.mstSvtCoin[a].summonNum+
'</div><div style="width:10px;display:inline-block;"></div>';n+="</td></tr>";break}for(a=0;a<master.mstSvtAppendPassiveSkillUnlock.length;a++)if(master.mstSvtAppendPassiveSkillUnlock[a].svtId==master.mstSvt[k].id){n+="<tr><td>\u89e3\u653e</td><td>";for(d=0;d<master.mstSvtAppendPassiveSkillUnlock[a].itemIds.length;d++)l=master.mstItem[findName(master.mstItem,master.mstSvtAppendPassiveSkillUnlock[a].itemIds[d])],n+='<div class="itemMT" title="'+l.name+'" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/'+
l.imageId+".png')\" >"+master.mstSvtAppendPassiveSkillUnlock[a].itemNums[d]+'</div><div style="width:10px;display:inline-block;"></div>';n+="</td></tr>";break}for(a=0;a<master.mstCombineAppendPassiveSkill.length;a++)if(l="",0==a%2&&(l=' bgcolor=" #ECF2F3"'),master.mstCombineAppendPassiveSkill[a].svtId==master.mstSvt[k].id){1!=master.mstCombineAppendPassiveSkill[a].skillLv&&(n+="<tr>");n+="<td"+l+">Lv."+master.mstCombineAppendPassiveSkill[a].skillLv+"\u2192Lv."+(master.mstCombineAppendPassiveSkill[a].skillLv+
1)+"</td><td"+l+">";for(d=0;d<master.mstCombineAppendPassiveSkill[a].itemIds.length;d++)l=master.mstItem[findName(master.mstItem,master.mstCombineAppendPassiveSkill[a].itemIds[d])],n+='<a href="item_drop.html#'+l.id+'"><div class="itemMT" title="'+l.name+'" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/'+l.imageId+".png')\" >"+master.mstCombineAppendPassiveSkill[a].itemNums[d]+'</div></a><div style="width:10px;display:inline-block;"></div>';n+='<div class="itemMT" title="QP" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/5.png\')" >'+
numeral(master.mstCombineAppendPassiveSkill[a].qp).format("0a")+"</div>";n+="</td></tr>";y++}w=0==y?w+"<tr><th><b>\u9644\u52a0\u6280\u80fd\u5f37\u5316</b></th><td colspan=2>\u7121</td></tr>":w+("<tr><th rowspan="+(y+3)+"><b>\u9644\u52a0\u6280\u80fd\u5f37\u5316</b></th>"+n);y=0;n="";for(a=0;a<master.mstCombineCostume.length;a++)if(l="",0==a%2&&(l=' bgcolor=" #ECF2F3"'),master.mstCombineCostume[a].svtId==e){0!=y&&(n+="<tr>");n+="<td>";for(v in master.mstSvtCostume)if(master.mstSvtCostume[v].svtId==
e&&master.mstSvtCostume[v].id==master.mstCombineCostume[a].costumeId){l="";for(var z in master.mstSvtLimitAdd)if(master.mstSvtLimitAdd[z].svtId==e&&master.mstSvtLimitAdd[z].limitCount==master.mstCombineCostume[a].costumeId){l=master.mstSvtLimitAdd[z].battleCharaId;break}n+='<div class="itemMT" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/faces/'+l+'0.png\')" title="'+master.mstSvtCostume[v].name+'"></div>';break}n+="</td><td>";for(d=0;d<master.mstCombineCostume[a].itemIds.length;d++)l=
master.mstItem[findName(master.mstItem,master.mstCombineCostume[a].itemIds[d])],n+='<a href="item_drop.html#'+l.id+'"><div class="itemMT" title="'+l.name+'" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/'+l.imageId+".png')\" >"+master.mstCombineCostume[a].itemNums[d]+'</div></a><div style="width:10px;display:inline-block;"></div>';n+='<div class="itemMT" title="QP" style="background-image: url(\'https://fgo.kazemai.io/common/images/icon/items/5.png\')" >'+numeral(master.mstCombineCostume[a].qp).format("0a")+
"</div>";n+="</td>";y++}0!=y&&(w+="<tr><th rowspan="+y+"><b>\u9748\u8863\u958b\u653e</b></th>"+n);$("#svtCmbnData").html(w);$("#svtImgData").html('<tr><td><span id="cmd"><img src="https://fgo.kazemai.io/common/images/Servants/Commands/'+e+'/card_servant_1.png" style="" class="CommandCard vsvtImg"/><img src="https://fgo.kazemai.io/common/images/Servants/Commands/'+e+'/card_servant_2.png" style="" class=CommandCard "svtImg"/><img src="https://fgo.kazemai.io/common/images/Servants/Commands/'+e+'/card_servant_3.png" style="" class="CommandCard svtImg"/></span><br><span id="graph"><img src=https://fgo.kazemai.io/common/images/CharaGraph/'+
e+'a.png style="max-width:100%;" class="svtImg"/><img src=https://fgo.kazemai.io/common/images/CharaGraph/'+e+'b.png style="max-width:100%;" class="svtImg"/><img src=https://fgo.kazemai.io/common/images/CharaGraph/'+e+'c.png style="max-width:50%;" class="svtImg"/><img src=https://fgo.kazemai.io/common/images/CharaGraph/fate-gl/'+e+'c.png style="max-width:50%;" class="svtImg"/></span></td></tr>');$(".svtImg").error(function(){$(this).hide()});z=3;for(a in master.mstSvtLimitAdd)if(master.mstSvtLimitAdd[a].svtId==
master.mstSvt[k].id&&(4<master.mstSvtLimitAdd[a].limitCount&&($("#cmd").append('<img src="https://fgo.kazemai.io/common/images/Servants/Commands/'+e+"/card_servant_"+master.mstSvtLimitAdd[a].limitCount+'.png" style="" class="CommandCard svtImg"/>'),$("#graph").append("<img src=https://fgo.kazemai.io/common/images/CharaGraph/"+master.mstSvtLimitAdd[a].battleCharaId+'a.png style="max-width:50%;" class="svtImg"/>'),master.mstSvt[k].collectionNo<=statusNo&&$(".slide").append('<div><img src="https://fgo.kazemai.io/common/images/Servants/Status/'+
e+"/status_servant_"+master.mstSvtLimitAdd[a].limitCount+'.png" onerror="this.style.display = none" width=256 height=256 /></div>'),z++),d=[],0<master.mstSvtLimitAdd[a].individuality.length)){w=difference(master.mstSvtLimitAdd[a].individuality,master.mstSvt[k].individuality);if(-1!=master.mstSvtLimitAdd[a].attri)for(var A in master.mstAttri)if(master.mstAttri[A].id==master.mstSvtLimitAdd[a].attri){indi_list[master.mstAttri[A].individuality]&&d.push("\u66ff\u63db\u6210"+indi_list[master.mstAttri[A].individuality].name.replace(/@/g,
""));break}if(0<w.length){n=!1;for(v in master.mstSvtCostume)if(master.mstSvtCostume[v].id==master.mstSvtLimitAdd[a].limitCount&&master.mstSvtCostume[v].svtId==e){$("#indi").append("<br/>\u5207\u63db\u9748\u8863\u300c"+master.mstSvtCostume[v].shortName+"\u300d\u6642\u8ffd\u52a0\uff1a");n=!0;break}if(!n){n="";switch(master.mstSvtLimitAdd[a].limitCount){case 0:n+="\u9748\u57fa\u518d\u81e8\u521d\u59cb\u968e\u6bb5";break;case 4:n+="\u9748\u57fa\u518d\u81e8\u6700\u7d42\u968e\u6bb5";break;default:n+="\u9748\u57fa\u518d\u81e8\u7b2c"+
master.mstSvtLimitAdd[a].limitCount+"\u968e\u6bb5"}$("#indi").append("<br/>"+n+"\u6642\u8ffd\u52a0\uff1a")}for(b in w)indi_list[w[b]]&&d.push(indi_list[w[b]].name.replace(/@/g,""));$("#indi").append(""+d)}}for(a in master.mstSvtIndividuality)if(master.mstSvtIndividuality[a].svtId==e&&8E6>master.mstSvtIndividuality[a].idx&&-1==master.mstSvtIndividuality[a].limitCount){v=master.mstSvtIndividuality[a];A=!1;n="";for(b in v.individuality)"undefined"!=typeof indi_list[v.individuality[b]]&&(n+=indi_list[v.individuality[b]].name.replace(/@/g,
""),A=!0);if(A)switch(v.condType){case 0:$("#indi").append("<br/>\u984d\u5916\u7279\u6027"+v.idx+"\uff1a"+n);break;default:$("#indi").append("<br/>"+condtionRead(v.condType,v.condId,v.condNum)+"\uff1a"+n)}}$(".CommandCard").css("max-width",Math.floor(100/z)+"%");e="";null==t||m.hpBase==t.hpBase&&m.hpMax==t.hpMax&&m.atkBase==t.atkBase&&m.atkMax==t.atkMax||(m=t);if(99==master.mstSvt[k].type)$("#chart_div").css("display","none");else for($("#chart_div").css("display","block"),e="<tr><th>\u7b49\u7d1a</th><th>ATK</th><th>HP</th><th>\u4e0a\u5347\u5e45\u5ea6</th></tr>",
a=0;120>a;a++)for(n=0;n<master.mstSvtExp.length;n++)if(master.mstSvt[k].expType==master.mstSvtExp[n].type&&master.mstSvtExp[n].lv==a+1){l="";1==master.mstSvtExp[n].lv%2&&(l=' bgcolor="#ECF2F3"');e+='<tr align="center"><td'+l+">Lv."+master.mstSvtExp[n].lv+"</td><td"+l+">"+Math.floor(m.atkBase+(m.atkMax-m.atkBase)*master.mstSvtExp[n].curve/1E3)+"</td><td"+l+">"+Math.floor(m.hpBase+(m.hpMax-m.hpBase)*master.mstSvtExp[n].curve/1E3)+"</td><td"+l+">"+(master.mstSvtExp[n].curve-master.mstSvtExp[n-1].curve)/
10+"%</td></tr>";break}$("#svtLvData").html(e);$(".lazyload").lazyload();$("img").error(function(){$(this).css({visibility:"hidden"})});$(function(){$(".slide").slick({dots:!0,infinite:!0,speed:300,slidesToShow:1,adaptiveHeight:!0,autoplay:!0,autoplaySpeed:2E3})})}function difference(e,a){for(var k=[],m=0;m<e.length;m++)-1===a.indexOf(e[m])&&k.push(e[m]);return k}
function cmtRead(e){try{var a=$("#svtid").val(),k;for(k in master.mstSvtTransform)if(master.mstSvtTransform[k].aftSvtId==a){a=master.mstSvtTransform[k].befSvtId;break}$("#svtCmtData").empty();$.get("common/svtcomment/"+e+"/"+a,function(m){0==m.length&&(m="W10=");m=JSON.parse(base64.decode(m));cmp=function(p,x){return p>x?1:p<x?-1:0};m.sort(function(p,x){return cmp([cmp(p.priority,x.priority),cmp(p.id,x.id)],[cmp(x.priority,p.priority),cmp(x.id,p.id)])});var t="",c="",d;for(d in m){t=0;t=null!=m[d].condValues&&
0<m[d].condValues.length?m[d].condValues[0]:m[d].condValue;c+="<tr><th width=250>"+cmtCond(m[d].condType,t);for(var u in master.mstSvtCommentAdd)master.mstSvtCommentAdd[u].svtId==m[d].svtId&&master.mstSvtCommentAdd[u].id==m[d].id&&master.mstSvtCommentAdd[u].priority==m[d].priority&&(c+="<br>\uff06<br>"+cmtCond(master.mstSvtCommentAdd[u].condType,master.mstSvtCommentAdd[u].condValues[0]));t=0==d%2?' bgcolor=" #ECF2F3"':"";c+="</th><td colspan=6"+t+" width=540>";c+=m[d].comment.replace(/\n/g,"<br>").replace(/<br>$/,
"<br><br>")+"</td></tr>"}0==m.length&&(c="");$("#svtCmtData").append(c)},"text")}catch(m){console.log("Cannot find comment file."),"zh"==e&&cmtRead("jp")}}function cmtCond(e,a){var k="";0==e?k+="<b>\u89d2\u8272\u8a73\u7d30</b>":9==e?k+="<b>\u7d46\u7b49\u7d1a"+a+"</b>":1==e?k+="<b>\u901a\u904e\u95dc\u5361</b><br>"+questRea(a).replace(/\n/g,"&#xa;"):7==e&&(k+="<b>\u9748\u57fa\u518d\u81e8\u7b2c"+a+"\u968e\u6bb5</b>");return k}
function classidChange(){var e;for(e=svtid.options.length-1;0<=e;e--)svtid.remove(e);for(e=0;e<master.mstSvt.length;e++)if(0==classid.value||master.mstSvt[e].classId==classid.value)if(1==master.mstSvt[e].type||2==master.mstSvt[e].type||5==master.mstSvt[e].type||9==master.mstSvt[e].type||99==master.mstSvt[e].type){var a=findSvtNameZh(master.mstSvt[e].id);a?svtid.options.add(new Option("No."+master.mstSvt[e].collectionNo+" "+a,master.mstSvt[e].id)):svtid.options.add(new Option("No."+master.mstSvt[e].collectionNo+
" "+master.mstSvt[e].name,master.mstSvt[e].id))}for(e=0;e<svtid.options.length;e++)if(-1==svtid.options[e].text.search("No.0")){svtid.options[e].selected=!0;break}0!=classid.value&&svtlocation(svtid[svtid.options.selectedIndex].value)}function svtidset(){classidChange();svtlocation(svtid[0].value)}
function svtidChange(){var e;for(e=svtlv.options.length-1;0<=e;e--)svtlv.remove(e);for(e in master.mstSvt)if(master.mstSvt[e].id==svtid.value){for(e=120;0<e;e--)svtlv.options.add(new Option("Lv."+e,e));break}svtlvChange();svtDataTable(svtid.value);drawChart()}
function svtlocation(e){e="";for(var a in master.mstSvt)if(master.mstSvt[a].id==svtid.value){e=0!=master.mstSvt[a].collectionNo?e+("?no="+master.mstSvt[a].collectionNo):e+("?id="+master.mstSvt[a].id);break}"file:"==location.protocol?changeURL(location.protocol+"//"+location.pathname+e):changeURL(location.protocol+"//"+location.hostname+location.pathname+e);svtidChange()}
function svtlvChange(){var e,a=0,k=0,m=0,t=0;for(e in master.mstSvtLimit)master.mstSvtLimit[e].svtId==svtid.value&&(a=master.mstSvtLimit[e].hpBase,k=master.mstSvtLimit[e].hpMax,m=master.mstSvtLimit[e].atkBase,t=master.mstSvtLimit[e].atkMax);for(var c in master.mstSvt)if(master.mstSvt[c].id==svtid.value){for(var d in master.mstSvtExp)if(atk.value=m,hp.value=a,four(),master.mstSvt[c].expType==master.mstSvtExp[d].type&&master.mstSvtExp[d].lv==svtlv.value){atk.value=Math.floor(m+(t-m)*master.mstSvtExp[d].curve/
1E3);hp.value=Math.floor(a+(k-a)*master.mstSvtExp[d].curve/1E3);four();break}break}}function four(){hpp.value=parseInt(hp.value)+2E3;atkp.value=parseInt(atk.value)+2E3}function npArray(e){var a="",k;for(k in e)a+=e[k]/100+"%<br>";return a}function svtTranform(e){$("#svtid").val(e);svtidChange()}
function urlId(){$("#zhTWNO").html(zhTWNo);$("#zhCNNO").html(zhCNNo);$("#classid").val(0);classidChange();var e="1",a="";getUrl("no")&&(e=getUrl("no"));getUrl("id")&&(a=getUrl("id"));if(e){if(0!=a.length)for(i in master.mstSvt){if((1==master.mstSvt[i].type||2==master.mstSvt[i].type||5==master.mstSvt[i].type||9==master.mstSvt[i].type||99==master.mstSvt[i].type)&&a==master.mstSvt[i].id){$("#svtid").val(master.mstSvt[i].id);break}}else for(i in master.mstSvt)if((1==master.mstSvt[i].type||2==master.mstSvt[i].type||
5==master.mstSvt[i].type||9==master.mstSvt[i].type||99==master.mstSvt[i].type)&&e==master.mstSvt[i].collectionNo){$("#svtid").val(master.mstSvt[i].id);break}i==master.mstSvt.length-1&&$("#svtid").val(800100)}svtidChange()};